package:
  name: var-transform-used-in-test-env
  version: 1.2.3
  epoch: 0
  description: Test package with var-transform used in test environment variable
  copyright:
    - license: MIT

environment:
  contents:
    packages:
      - build-base
      - busybox

var-transforms:
  - from: ${{package.version}}
    match: (\d).(\d+).(\d+)
    replace: "$1.$2"
    to: short-version

pipeline:
  - runs: echo "building"

test:
  environment:
    environment:
      MY_VERSION: ${{vars.short-version}}
  pipeline:
    - runs: echo "Testing with version $MY_VERSION"

update:
  enabled: true
  github:
    identifier: example/repo
