.TH "WOLFICTL\-SCAN" "1" "" "Auto generated by spf13/cobra" "" 
.nh
.ad l


.SH NAME
.PP
wolfictl\-scan \- Scan a package for vulnerabilities


.SH SYNOPSIS
.PP
\fBwolfictl scan [ \-\-sbom | \-\-build\-log | \-\-remote ] [ \-\-advisory\-filter <type> \-\-advisories\-repo\-dir <path> ] target... [flags]\fP


.SH DESCRIPTION
.PP
This command scans one or more distro packages for vulnerabilities.

.SH SCANNING
.PP
There are four ways to specify the package(s) to scan:

.RS
.IP "  1." 5

.PP
Specify the path to the APK file(s) to scan.
.IP "  2." 5

.PP
Specify the path to the APK SBOM file(s) to scan. (The SBOM is expected to
use the Syft JSON format and can be created with the "wolfictl sbom \-o
syft\-json ..." command.)
.IP "  3." 5

.PP
Specify the path to a Melange build log file (or to a directory that
contains a build log file named "packages.log"). The build log file will be
parsed to find the APK files to scan.
.IP "  4." 5

.PP
Specify the name(s) of package(s) in the Wolfi package repository. The
latest versions of the package(s) for all supported architectures will be
downloaded from the Wolfi package repository and scanned.

.RE

.SH FILTERING
.PP
By default, the command will print all vulnerabilities found in the package(s)
to stdout. You can filter the vulnerabilities shown using existing local
advisory data. To do this, you must first clone the advisory data from the
advisories repository for the distro whose packages you are scanning. You
specify the path to the local advisories repository using the
\-\-advisories\-repo\-dir flag for the repository. Then, you can use the
"\-\-advisory\-filter" flag to specify which set of advisories to use for
filtering. The following sets of advisories are available:

.RS
.IP \(bu 2

.PP
"resolved": Only filter out vulnerabilities that have been resolved in the
distro.
.IP \(bu 2

.PP
"all": Filter out all vulnerabilities that are referenced from any advisory
in the advisories repository.
.IP \(bu 2

.PP
"concluded": Only filter out all vulnerabilities that have been fixed, or those
where no change is planned to fix the vulnerability.

.RE

.SH OUTPUT
.PP
When a scan finishes, the command will print the results to stdout. There are
two modes of output that can be specified with the \-\-output (or "\-o") flag:

.RS
.IP \(bu 2

.PP
"outline": This is the default output mode. It prints the results in a
human\-readable outline format.
.IP \(bu 2

.PP
"json": This mode prints the results in JSON format. This mode is useful for
machine processing of the results.

.RE

.PP
The command will exit with a non\-zero exit code if any errors occur during the
scan.

.PP
The command will also exit with a non\-zero exit code if any vulnerabilities are
found and the \-\-require\-zero flag is specified.


.SH OPTIONS
.PP
\fB\-a\fP, \fB\-\-advisories\-repo\-dir\fP=""
    directory containing the advisories repository

.PP
\fB\-f\fP, \fB\-\-advisory\-filter\fP=""
    exclude vulnerability matches that are referenced from the specified set of advisories (resolved|all|concluded)

.PP
\fB\-\-build\-log\fP[=false]
    treat input as a package build log file (or a directory that contains a packages.log file)

.PP
\fB\-D\fP, \fB\-\-disable\-sbom\-cache\fP[=false]
    don't use the SBOM cache

.PP
\fB\-\-distro\fP="wolfi"
    distro to use during vulnerability matching

.PP
\fB\-h\fP, \fB\-\-help\fP[=false]
    help for scan

.PP
\fB\-\-local\-file\-grype\-db\fP=""
    import a local grype db file

.PP
\fB\-o\fP, \fB\-\-output\fP=""
    output format (outline|json), defaults to outline

.PP
\fB\-r\fP, \fB\-\-remote\fP[=false]
    treat input(s) as the name(s) of package(s) in the Wolfi package repository to download and scan the latest versions of

.PP
\fB\-\-require\-zero\fP[=false]
    exit 1 if any vulnerabilities are found

.PP
\fB\-s\fP, \fB\-\-sbom\fP[=false]
    treat input(s) as SBOM(s) of APK(s) instead of as actual APK(s)

.PP
\fB\-\-use\-cpes\fP[=false]
    turn on all CPE matching in Grype


.SH OPTIONS INHERITED FROM PARENT COMMANDS
.PP
\fB\-\-log\-level\fP="INFO"
    log level (e.g. debug, info, warn, error)


.SH EXAMPLE

.SH Scan a single APK file
.PP
wolfictl scan /path/to/package.apk


.SH Scan multiple APK files
.PP
wolfictl scan /path/to/package1.apk /path/to/package2.apk


.SH Scan a single SBOM file
.PP
wolfictl scan /path/to/package.sbom \-\-sbom


.SH Scan a directory containing a build log file
.PP
wolfictl scan /path/to/build/log/dir \-\-build\-log


.SH Scan a single package in the Wolfi package repository
.PP
wolfictl scan package\-name \-\-remote


.SH Scan multiple packages in the Wolfi package repository
.PP
wolfictl scan package1 package2 \-\-remote


.SH SEE ALSO
.PP
\fBwolfictl(1)\fP
